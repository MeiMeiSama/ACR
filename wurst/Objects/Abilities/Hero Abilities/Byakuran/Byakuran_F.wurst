package Byakuran_F

import ClosureEvents
import ClosureTimers
import ACR_TagSystem
int byakuranFCount = 0

public function byakuranF ()
    let abilityF = 'A0KT'
    let buffF = 'B03I'

    EventListener.onCast(abilityF) (unit caster) ->
        byakuranFCount = 0
        caster.disableAbility(abilityF, true, false)
        abilityF.addTagDisabled()
        caster.issueImmediateOrder("stop")
        doPeriodically(0.03) (CallbackPeriodic cb) ->
            if caster.isPaused() == false
                byakuranFCount++
 
            if caster.hasAbility(buffF) == false
                caster.disableAbility(abilityF, false, false)
                abilityF.removeTagDisabled()
                caster.startAbilityCooldown(abilityF)
                destroy cb

            if byakuranFCount == 100
                caster.removeAbility(buffF)
                caster.disableAbility(abilityF, false, false)
                abilityF.removeTagDisabled()
                caster.startAbilityCooldown(abilityF)
                destroy cb
            
